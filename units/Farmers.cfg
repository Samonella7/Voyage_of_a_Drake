#textdomain wesnoth-voadar
[unit_type]
	# Events related to this unit are kept here for organizational purposes.
	# Standard unit data is below
	
	# This file contains all the controls for Vyncent and Pema, 
	# and the basic controls for their kids
	
	#first off, include the definition of the ants mini-game
    {~add-ons/Voyage_of_a_Drake/utils/mini_game_ants.cfg}
	
# since most of Vyncent's item conversations only make sense if he's busy,
# they're removed and re-added frequently.
# That means it's very convinient to have this list saved: it is all his items
# (except hat and letter, which don't change so frequently)
#define VYNCENT_ITEM_LIST
herb_bag,sword,ale,meat,net,charm,bear_claws,earmuffs#enddef

# A macro to move the entire family to a location
# works just like VOADAR_SET_DESTINATION, except it moves all four of them
# Also, ON_INDIVIDUAL_ARRIVAL_WML is triggered once when each family member 
# arrives, and ON_COMPLETE_ARRIVAL_WML fires only once, after all four members' 
# individual WML has been fired.
# NOTE: if ON_INDIVIDUAL_ARRIVAL_WML doesn't move/teleport the arriving unit, others may
# be blocked from arriving
#define VOADAR_MOVE_FAMILY X Y ON_INDIVIDUAL_ARRIVAL_WML ON_COMPLETE_ARRIVAL_WML
	{VARIABLE farmers.num_arrived 0}
	{VOADAR_REMOVE_EVENT farmers_complete_arrival}
	{VARIABLE farmers.num_arrived 0}
	{VOADAR_SET_DESTINATION Vyncent {X} {Y} (
		{VARIABLE_OP farmers.num_arrived add 1}
		{ON_INDIVIDUAL_ARRIVAL_WML}
		[fire_event]
			name=farmers_complete_arrival
		[/fire_event]
	)}
	{VARIABLE farmers.num_arrived 0}
	{VOADAR_SET_DESTINATION Nyssa {X} {Y} (
		{VARIABLE_OP farmers.num_arrived add 1}
		{ON_INDIVIDUAL_ARRIVAL_WML}
		[fire_event]
			name=farmers_complete_arrival
		[/fire_event]
	)}
	{VARIABLE farmers.num_arrived 0}
	{VOADAR_SET_DESTINATION Todd {X} {Y} (
		{VARIABLE_OP farmers.num_arrived add 1}
		{ON_INDIVIDUAL_ARRIVAL_WML}
		[fire_event]
			name=farmers_complete_arrival
		[/fire_event]
	)}
	{VOADAR_SET_DESTINATION Pema {X} {Y} (
		{VARIABLE_OP farmers.num_arrived add 1}
		{ON_INDIVIDUAL_ARRIVAL_WML}
		[fire_event]
			name=farmers_complete_arrival
		[/fire_event]
	)}
	[event]
		name=farmers_complete_arrival
		id=farmers_complete_arrival
		first_time_only=yes
		{VOADAR_FILTER_VARIABLE farmers.num_arrived 4}
		{ON_COMPLETE_ARRIVAL_WML}
	[/event]
#enddef
	
	[event]
		name=voadar_new_schedule
		id=farmers_new_schedule
		first_time_only=no
		[switch]
			variable=schedule.current
			[case]
				value=1,2
				# On normal days they all go outside
				{VARIABLE Vyncent.conversation farmers_conversation_morning}
				{VARIABLE Nyssa.conversation farmers_conversation_morning}
				{VARIABLE Todd.conversation farmers_conversation_morning}
				{VARIABLE Pema.conversation farmers_conversation_morning}
				[event]
					name=side 2 turn
					[fire_event]
						name=farmers_lock_up
						[primary_unit]
							id=Pema
						[/primary_unit]
					[/fire_event]
				[/event]
				{VOADAR_MOVE_FAMILY 71 35 (
					# For each arrival:
					{TELEPORT_UNIT (
						side=2
						[filter_location]
							x,y=71,35
							radius=1
						[/filter_location]
					) 78 41}
				) (
					# Once all are out:
					{VOADAR_ADD_ITEMS Vyncent {VYNCENT_ITEM_LIST}}
					{MOVE_UNIT (id=Vyncent) 76 40}
					{MOVE_UNIT (id=Nyssa) 76 40}
					{MOVE_UNIT (id=Todd) 76 40}
					{MOVE_UNIT (id=Pema) 76 40}
					{VOADAR_SET_SIMPLE_DESTINATION Pema 83 45}
					{IF_VAR Vyncent.mud_is_finished equals yes (
						[then]
							{VOADAR_SET_DESTINATION Vyncent 90 43 (
								{VARIABLE Vyncent.conversation Vyncent_conversation_work}
							)}
						[/then]
						[else]
							{VOADAR_SET_DESTINATION Vyncent 92 43 (
								{VARIABLE Vyncent.conversation Vyncent_conversation_mud}
							)}
						[/else]
					)}
					{VOADAR_SET_SIMPLE_DESTINATION Nyssa 81 47}
					{VOADAR_SET_SIMPLE_DESTINATION Todd 85 45}
					[event]
						name=side 2 turn
						{VARIABLE Nyssa.conversation Nyssa_conversation_work}
						{VARIABLE Todd.conversation Todd_conversation_work}
						{VARIABLE Pema.conversation Pema_conversation_launch_ants}
					[/event]
					[event]
						name=new turn
						{VOADAR_FILTER_VARIABLE schedule.hour 10}
						# last turn was your last chance to start the mini-game:
						{IF_VAR Pema.mini_game_is_going equals no (
							[then]
								{VARIABLE Pema.conversation Pema_conversation_work}
							[/then]
						)}
					[/event]
				)}
			[/case]
			[else]
				# At night they all go inside
				[event]
					name=side 2 turn
					{VARIABLE Vyncent.conversation Vyncent_conversation_work}
					{VOADAR_MOVE_FAMILY 78 41 (
						# For each arrival:
						{TELEPORT_UNIT (
							side=2
							[filter_location]
								x,y=78,41
								radius=1
							[/filter_location]
						) 72 35}
					) (
						# Once all are in:
						{VARIABLE farmers.locked_barn no}
						{MOVE_UNIT (id=Vyncent) 74 33}
						{VARIABLE Vyncent.conversation farmer_parents_conversation_night}
						{MOVE_UNIT (id=Nyssa) 74 33}
						{VARIABLE Nyssa.conversation Nyssa_conversation_after_work}
						{MOVE_UNIT (id=Todd) 74 33}
						{VARIABLE Todd.conversation Todd_conversation_after_work}
						{MOVE_UNIT (id=Pema) 74 33}
						{VARIABLE Pema.conversation Pema_conversation_after_work}
						{VOADAR_SET_SIMPLE_DESTINATION Vyncent 70 28}
						{VOADAR_SET_DESTINATION Pema 69 28 (
							{VARIABLE Pema.conversation farmer_parents_conversation_night}
						)}
						{VOADAR_SET_DESTINATION Nyssa 73 27 (
							{VARIABLE Nyssa.conversation Nyssa_conversation_night}
						)}
						{VOADAR_SET_DESTINATION Todd 75 27 (
							{VARIABLE Todd.conversation Todd_conversation_night}
						)}
						{VOADAR_REMOVE_ITEMS Vyncent {VYNCENT_ITEM_LIST}}
					)}
				[/event]
			[/else]
			[case]
				value=3
				# On day 3 they go to the Union
				[fire_event]
					name=farmers_load_cart
				[/fire_event]
				{VOADAR_SET_DESTINATION farmer_cart_occupied 71 35 (
					[fire_event]
						name=farmers_lock_up
						[primary_unit]
							id=farmer_cart_occupied
						[/primary_unit]
					[/fire_event]
					{TELEPORT_UNIT (id=farmer_cart_occupied) 78 41}
					{MOVE_UNIT (id=farmer_cart_occupied) 76 41}
					[modify_unit]
						[filter]
							id=farmer_cart_occupied
						[/filter]
						moves=0
					[/modify_unit]
					{VOADAR_SET_DESTINATION farmer_cart_occupied 73 41 (
						{TELEPORT_UNIT (id=farmer_cart_occupied) 58 33}
						{MOVE_UNIT (id=farmer_cart_occupied) 56 32}
						[modify_unit]
							[filter]
								id=farmer_cart_occupied
							[/filter]
							moves=0
						[/modify_unit]
						{VOADAR_SET_DESTINATION farmer_cart_occupied 55 31 (
							#
							# At this point, the cart arrived at the village stable.
							#
							{TELEPORT_UNIT (id=farmer_cart_occupied) 78 13}
							{MOVE_UNIT (id=farmer_cart_occupied) 82 15}
							[fire_event]
								name=farmers_leave_cart
							[/fire_event]
							# Its not union time yet, so go buy some fish:
							{MOVE_UNIT (id=Vyncent) 78 13}
							{TELEPORT_UNIT (id=Vyncent) 56 30}
							{MOVE_UNIT (id=Vyncent) 45 28}
							{MOVE_UNIT (id=Nyssa) 78 13}
							{TELEPORT_UNIT (id=Nyssa) 56 30}
							{MOVE_UNIT (id=Nyssa) 46 27}
							{MOVE_UNIT (id=Todd) 78 13}
							{TELEPORT_UNIT (id=Todd) 56 30}
							{MOVE_UNIT (id=Todd) 47 29}
							{MOVE_UNIT (id=Pema) 78 13}
							{TELEPORT_UNIT (id=Pema) 56 30}
							{MOVE_UNIT (id=Pema) 47 28}
							{VARIABLE Vyncent.conversation farmers_conversation_fish}
							{VARIABLE Nyssa.conversation farmers_conversation_fish}
							{VARIABLE Todd.conversation farmers_conversation_fish}
							{VARIABLE Pema.conversation farmers_conversation_fish}
							
							# Finally, actually go to the chapel:
							[event]
								name=side 2 turn
								{VOADAR_FILTER_TIME_UNION_START}
								
								{MOVE_UNIT (id=Vyncent) 48 22}
								{TELEPORT_UNIT (id=Vyncent) 31 9}
								{MOVE_UNIT (id=Vyncent) 34 6}
								{MOVE_UNIT (id=Nyssa) 48 22}
								{TELEPORT_UNIT (id=Nyssa) 31 9}
								{MOVE_UNIT (id=Nyssa) 32 6}
								{MOVE_UNIT (id=Todd) 48 22}
								{TELEPORT_UNIT (id=Todd) 31 9}
								{MOVE_UNIT (id=Todd) 34 5}
								{MOVE_UNIT (id=Pema) 48 22}
								{TELEPORT_UNIT (id=Pema) 31 9}
								{MOVE_UNIT (id=Pema) 33 6}
								{VARIABLE Vyncent.conversation Vyncent_conversation_union}
								{VARIABLE Nyssa.conversation Nyssa_conversation_union}
								{VARIABLE Todd.conversation Todd_conversation_union}
								{VARIABLE Pema.conversation Pema_conversation_union}
							[/event]
						)}
						
						# This is when the farmers leave the Union:
						[event]
							name=new turn
							{VOADAR_FILTER_TIME_UNION_OVER}
							{MOVE_UNIT (id=Vyncent) 31 9}
							{TELEPORT_UNIT (id=Vyncent) 48 22}
							{MOVE_UNIT (id=Vyncent) 49 25}
							{MOVE_UNIT (id=Nyssa) 31 9}
							{TELEPORT_UNIT (id=Nyssa) 48 22}
							{MOVE_UNIT (id=Nyssa) 49 25}
							{MOVE_UNIT (id=Todd) 31 9}
							{TELEPORT_UNIT (id=Todd) 48 22}
							{MOVE_UNIT (id=Todd) 49 25}
							{MOVE_UNIT (id=Pema) 31 9}
							{TELEPORT_UNIT (id=Pema) 48 22}
							{MOVE_UNIT (id=Pema) 49 25}
							{VARIABLE Vyncent.conversation farmer_conversation_after_union}
							{VARIABLE Nyssa.conversation farmer_conversation_after_union}
							{VARIABLE Todd.conversation farmer_conversation_after_union}
							{VARIABLE Pema.conversation farmer_conversation_after_union}
							[event]
								name=side 2 turn
								# the next turn, continue movement
								{MOVE_UNIT (id=Vyncent) 55 30}
								{TELEPORT_UNIT (id=Vyncent) 78 13}
								{MOVE_UNIT (id=Vyncent) 81 15}
								{MOVE_UNIT (id=Nyssa) 55 30}
								{TELEPORT_UNIT (id=Nyssa) 78 13}
								{MOVE_UNIT (id=Nyssa) 81 15}
								{MOVE_UNIT (id=Todd) 55 30}
								{TELEPORT_UNIT (id=Todd) 78 13}
								{MOVE_UNIT (id=Todd) 81 15}
								{MOVE_UNIT (id=Pema) 55 30}
								{TELEPORT_UNIT (id=Pema) 78 13}
								{MOVE_UNIT (id=Pema) 81 15}
								{MOVE_UNIT (id=farmer_cart) 82 16}
								[fire_event]
									name=farmers_load_cart
								[/fire_event]
								[modify_unit]
									[filter]
										id=farmer_cart_occupied
									[/filter]
									moves=0
								[/modify_unit]
								{VOADAR_SET_DESTINATION farmer_cart_occupied 78 13 (
									{TELEPORT_UNIT (id=farmer_cart_occupied) 56 30}
									{MOVE_UNIT (id=farmer_cart_occupied) 56 32}
									[modify_unit]
										[filter]
											id=farmer_cart_occupied
										[/filter]
										moves=0
									[/modify_unit]
									{VOADAR_SET_DESTINATION farmer_cart_occupied 58 33 (
										{TELEPORT_UNIT (id=farmer_cart_occupied) 73 41}
										{MOVE_UNIT (id=farmer_cart_occupied) 76 41}
										[modify_unit]
											[filter]
												id=farmer_cart_occupied
											[/filter]
											moves=0
										[/modify_unit]
										{VOADAR_SET_DESTINATION farmer_cart_occupied 78 41 (
											# now the cart arrives home. The family steps outside to eat their fish
											# this way, they end up outside at the farm,
											# which is where the night schedule expects them to be
											
											{TELEPORT_UNIT (id=farmer_cart_occupied) 71 35}
											{MOVE_UNIT (id=farmer_cart_occupied) 73 33}
											[fire_event]
												name=farmers_leave_cart
											[/fire_event]
											{MOVE_UNIT (id=Vyncent) 71 35}
											{TELEPORT_UNIT (id=Vyncent) 78 41}
											{MOVE_UNIT (id=Vyncent) 76 41}
											{MOVE_UNIT (id=Nyssa) 71 35}
											{TELEPORT_UNIT (id=Nyssa) 78 41}
											{MOVE_UNIT (id=Nyssa) 76 41}
											{MOVE_UNIT (id=Todd) 71 35}
											{TELEPORT_UNIT (id=Todd) 78 41}
											{MOVE_UNIT (id=Todd) 76 41}
											{MOVE_UNIT (id=Pema) 71 35}
											{TELEPORT_UNIT (id=Pema) 78 41}
											{MOVE_UNIT (id=Pema) 76 41}
											{VARIABLE Vyncent.conversation farmers_conversation_eating}
											{VARIABLE Nyssa.conversation farmers_conversation_eating}
											{VARIABLE Todd.conversation farmers_conversation_eating}
											{VARIABLE Pema.conversation farmers_conversation_eating}
										)}
									)}
								)}
							[/event]
						[/event]
					)}
				)}
			[/case]
		[/switch]
	[/event]
	
	# Helper events for moving the farmer family around
	[event]
		name=farmers_load_cart
		id=farmers_load_cart
		first_time_only=no
		[store_unit]
			[filter]
				id=farmer_cart
			[/filter]
			variable=farmers.cart
		[/store_unit]
		{MOVE_UNIT (id=Vyncent) $farmers.cart.x| $farmers.cart.y|}
		{VOADAR_STORE_UNIT Vyncent yes}
		[unstore_unit]
			variable=farmers.cart_occupied
			x,y=$farmers.cart.x|,$farmers.cart.y|
			find_vacant=no
		[/unstore_unit]
		{MOVE_UNIT (id=Nyssa) $farmers.cart.x| $farmers.cart.y|}
		{VOADAR_STORE_UNIT Nyssa yes}
		{MOVE_UNIT (id=Todd) $farmers.cart.x| $farmers.cart.y|}
		{VOADAR_STORE_UNIT Todd yes}
		{MOVE_UNIT (id=Pema) $farmers.cart.x| $farmers.cart.y|}
		{VOADAR_STORE_UNIT Pema yes}
	[/event]
	[event]
		name=farmers_leave_cart
		id=farmers_leave_cart
		first_time_only=no
		[store_unit]
			[filter]
				id=farmer_cart_occupied
			[/filter]
			variable=farmers.cart_occupied
		[/store_unit]
		[unstore_unit]
			variable=farmers.cart
			x,y=$farmers.cart_occupied.x|,$farmers.cart_occupied.y|
			find_vacant=no
		[/unstore_unit]
		[unstore_unit]
			find_vacant=yes
			variable=Vyncent.unit
			x,y=$farmers.cart_occupied.x|,$farmers.cart_occupied.y|
		[/unstore_unit]
		[unstore_unit]
			find_vacant=yes
			variable=Nyssa.unit
			x,y=$farmers.cart_occupied.x|,$farmers.cart_occupied.y|
		[/unstore_unit]
		[unstore_unit]
			find_vacant=yes
			variable=Todd.unit
			x,y=$farmers.cart_occupied.x|,$farmers.cart_occupied.y|
		[/unstore_unit]
		[unstore_unit]
			find_vacant=yes
			variable=Pema.unit
			x,y=$farmers.cart_occupied.x|,$farmers.cart_occupied.y|
		[/unstore_unit]
	[/event]
	
	###################################################### Schedule ends, conversations begin
	
	[event]
		name=Voadar_remembers_farmers
		id=Voadar_remembers_farmers
		first_time_only=yes
		# Most units/groups have a "meet Voadar" event, but you and these farmers already met.
		# you just get a narrator message that explains a bit
		{VOADAR_MESSAGE_NARRATOR (_"This is a member of a family of farmers; you met them some time ago. They were the only farmers besides Cadameron who lived near Raplice, but Vyncent, the family's father, never really got along with Cadameron because he was jealous of Cadameron's fertile valley.")}
		{VOADAR_ADD_ITEMS Vyncent hat}
		# Vyncent's other items are regularly added and removed in his schedule, because the conversations only make sense while he's in the field
		{VOADAR_ADD_ITEMS Nyssa hat,herb_bag,net,sword,earmuffs,bear_claws}
		{VOADAR_ADD_ITEMS Todd charm,meat,ale,sword,bear_claws,fish}
		{VOADAR_ADD_ITEMS Pema hat,meat,net,herb_bag,charm}
	[/event]
	
	[event]
		name=farmer_cart_occupied_conversation
		id=farmer_cart_occupied_conversation
		first_time_only=no
		[message]
			speaker=farmer_cart_occupied
			caption=_"Vyncent"
			message=_"Todd!! For heaven's sake, we have made this trip hundreds of times! You know perfectly well how long the road is, so there is absolutely no reason for you to keep asking me whether we have arrived!"
		[/message]
		[message]
			speaker=farmer_cart_occupied
			caption=_"Todd"
			message=_"<i>(Giggles)</i> We there yet?"
		[/message]
		[message]
			speaker=farmer_cart_occupied
			caption=_"Vyncent"
			message=_"Augh!"
		[/message]
	[/event]
	
	[event]
		name=farmers_conversation_morning
		id=farmers_conversation_morning
		first_time_only=no
		[fire_event]
			name=Voadar_remembers_farmers
			# Voadar_remembers_farmers has first_time_only=yes, 
			# so this tag only does something if the player hasn't met the farmers yet
		[/fire_event]
		{VOADAR_MESSAGE Pema (_"Good morning, kids. How did you sleep?")}
		{VOADAR_MESSAGE Todd (_"Slept bad! I going back to bed.")}
		{VOADAR_MESSAGE Nyssa (_"Maybe you'd feel better if you weren't so busy keeping me awake all night long...")}
	[/event]
	
	[event]
		name=farmers_conversation_fish
		id=farmers_conversation_fish
		first_time_only=no
		[fire_event]
			name=Voadar_remembers_farmers
			# Voadar_remembers_farmers has first_time_only=yes, 
			# so this tag only does something if the player hasn't met the farmers yet
		[/fire_event]
		{VOADAR_MESSAGE Pema (_"Good to see you again, Juditha! How has the business been? How is Rachael?")}
		{VOADAR_MESSAGE Juditha (_"Both fine. Hey drake, get out of here! Leave us alone!")}
		[fire_event]
			name=Voadar_responds
		[/fire_event]
		{IF_VAR Voadar.response equals 4 (
			[then]
				{VOADAR_MESSAGE Juditha (_"Don't make me call the guards!")}
			[/then]
		)}
		{VOADAR_MESSAGE Pema (_"Juditha, I really think that Voa-- NO Todd! Come back here, stay out of that pond! You'll get all w--")}
		{VOADAR_MESSAGE Todd (_"<i>(SPLASH!)</i> I all wet!")}
	[/event]
	
	[event]
		name=farmers_conversation_eating
		id=farmers_conversation_eating
		first_time_only=no
		[fire_event]
			name=Voadar_remembers_farmers
			# Voadar_remembers_farmers has first_time_only=yes, 
			# so this tag only does something if the player hasn't met the farmers yet
		[/fire_event]
		{VOADAR_MESSAGE Pema (_"Oh, hello Voadar! We were just having our family dinner! It's a family tradition to buy some fish whenever we go to town for Union.")}
		{VOADAR_MESSAGE Todd (_"An' I got best one! My fish is the best! <i>(Takes huge bite out of its head)</i>")}
		{VOADAR_MESSAGE Pema (_"Careful, dear! Let me get the bones out for you...")}
	[/event]
	
	[event]
		name=farmer_conversation_after_union
		id=farmer_conversation_after_union
		first_time_only=no
		[fire_event]
			name=Voadar_remembers_farmers
			# Voadar_remembers_farmers has first_time_only=yes, 
			# so this tag only does something if the player hasn't met the farmers yet
		[/fire_event]
		{VOADAR_MESSAGE Nyssa (_"Mom, who do those big houses belong to? They're even bigger than the chapel!")}
		{VOADAR_MESSAGE Pema (_"The green one belongs to the priest and his family. They have a big house becuase they have a lot of money.")}
		{VOADAR_MESSAGE Vyncent (_"And the red and white one belongs to the $d|mayor.$b| He lives in a big house because he takes a lot of money from everyone else.")}
		{VOADAR_MESSAGE Pema (_"<i>(Looks around, worried)</i> Dear!")}
	[/event]
	
	[event]
		name=Vyncent_conversation_work
		id=Vyncent_conversation_work
		first_time_only=no
		[fire_event]
			name=Voadar_remembers_farmers
			# Voadar_remembers_farmers has first_time_only=yes, 
			# so this tag only does something if the player hasn't met the farmers yet
		[/fire_event]
		{VOADAR_MESSAGE Vyncent (_"<i>(Doesn't see you)</i> Unng... always so much blasted... lucky to even have a... darned crops better... if we could at least get some...")}
		[fire_event]
			name=Voadar_responds
		[/fire_event]
		[switch]
			variable=Voadar.response
			[case]
				value=1,2
				{VOADAR_MESSAGE Vyncent (_"Huh? Oh, it's you... listen, I'm just trying to get some work done around here... Unless you want to $d|help$b| out, why don't you just leave?")}
			[/case]
			[case]
				value=4
				{VOADAR_MESSAGE Vyncent (_"YEAAaaa... Em, I knew you were there! I wasn't scared. Not even a little! I was yelling because, em, I stubbed my toe, that's all.")}
				[fire_event]
					name=Voadar_responds
				[/fire_event]
				{VOADAR_MESSAGE Vyncent (_"Em, listen, I'm just trying to get some work done around here... Unless you want to $d|help$b| out, why don't you just leave?")}
			[/case]
		[/switch]
		{IF_VAR Voadar.response not_equals 3 (
			[then]
				[fire_event]
					name=Voadar_responds
				[/fire_event]
				[switch]
					variable=Voadar.response
					[case]
						value=2
						{VOADAR_MESSAGE Vyncent (_"Could always use some help with that stupid irrigation... can never get rid of all the $d|mud$b| that blocks the water flow. Of course, you wouldn't know much about irrigation, would you? Your farm has a perfect little river that kept everything watered all on its own, doesn't it? <i>(Stomps off grumpily)</i>")}
					[/case]
					[case]
						value=4
					[/case]
				[/switch]
			[/then]
		)}
	[/event]
	
	
	[event]
		name=Vyncent_conversation_mud
		id=Vyncent_conversation_mud
		first_time_only=no
		[fire_event]
			name=Voadar_remembers_farmers
			# Voadar_remembers_farmers has first_time_only=yes, 
			# so this tag only does something if the player hasn't met the farmers yet
		[/fire_event]
		{VOADAR_MESSAGE Vyncent (_"BLASTED MUD!! Fine!! You can plug up my canal all you want, there's too much to do around here for me to spend all day shovelling you around! STUPID SLOGGY WET DIRT!!!")}
		{MOVE_UNIT (id=Vyncent) 93 42}
		{VOADAR_MESSAGE Vyncent (_"Oh... I didn't see you there. <i>(Looks at you grumpily)</i>")}
		[fire_event]
			name=Voadar_responds
		[/fire_event]
		[switch]
			variable=Voadar.response
			[case]
				value=1,2
				{VOADAR_MESSAGE Vyncent (_"Huh. I guess you wouldn't know much about irrigation canals... your farm has a perfect little stream running through that keeps everything watered all on its own, doesn't it? I guess that's why you have time to stand around here pointlessly...")}
			[/case]
			[else]
				value=3
				{VOADAR_MESSAGE Vyncent (_"...Whatever. I have work to do.")}
			[/else]
		[/switch]
		# he's not in the mud anymore, so back to the normal work conversation:
		{VARIABLE Vyncent.conversation Vyncent_conversation_work}
	[/event]
	
	[event]
		name=farmer_parents_conversation_night
		id=farmer_parents_conversation_night
		first_time_only=no
		[fire_event]
			name=Voadar_remembers_farmers
			# Voadar_remembers_farmers has first_time_only=yes, 
			# so this tag only does something if the player hasn't met the farmers yet
		[/fire_event]
		{VOADAR_MESSAGE Vyncent (_"So then I told him--")}
		{VOADAR_MESSAGE Pema (_"Voadar! What a pleasant surprise. How have you been?")}
		{VOADAR_MESSAGE Vyncent (_". . .")}
		{VOADAR_MESSAGE Pema (_"Vyncent, where are your manners? Say hello!")}
		{VOADAR_MESSAGE Vyncent (_"<i>(Looks at you grumpily)</i> So... how have you been, Voadar?")}
		[fire_event]
			name=Voadar_responds
		[/fire_event]
		{VOADAR_MESSAGE Vyncent (_"Pema, this is ridiculous. He doesn't even speak.")}
		{VOADAR_MESSAGE Pema (_"Please Vyncent, you know he can't help that. He's our friend anyway.")}
		{VOADAR_MESSAGE Vyncent (_"<i>(Still grumpy)</i> Yes, dear. Whatever you say, dear.")}
	[/event]
	
	[event]
		name=Vyncent_conversation_union
		id=Vyncent_conversation_union
		first_time_only=no
		[fire_event]
			name=Voadar_remembers_farmers
			# Voadar_remembers_farmers has first_time_only=yes, 
			# so this tag only does something if the player hasn't met the farmers yet
		[/fire_event]
		{VOADAR_MESSAGE Vyncent (_"<i>(Grumbles)</i> Just think how much work we could be getting done at the farm...")}
		{VOADAR_MESSAGE Pema (_"Dear, you know how important this is for the kids.")}
		{VOADAR_MESSAGE Vyncent (_"Yes, yes. Of course you're right dear.")}
	[/event]
	
	[event]
		name=Pema_conversation_launch_ants
		id=Pema_conversation_launch_ants
		first_time_only=no
		[fire_event]
			name=Voadar_remembers_farmers
			# Voadar_remembers_farmers has first_time_only=yes, 
			# so this tag only does something if the player hasn't met the farmers yet
		[/fire_event]
		{VOADAR_MESSAGE Pema (_"How are you, Voadar? I'm sorry I can't stop to talk, the field always keeps us so busy this time of year. But I'm sure you know all about that. I don't suppose you have any spare time..?")}
		{VARIABLE Voadar.bool_message (_"Help Pema with the farming?")}
		[fire_event]
			name=Voadar_bool_responds
		[/fire_event]
		{IF_VAR Voadar.bool_response equals yes (
			[then]
				[fire_event]
					name=launch_ants_mini_game
				[/fire_event]
			[/then]
			[else]
				{VOADAR_MESSAGE Pema (_"Well, thanks for stopping by anyway. You should visit in the evening sometime, once we've gone in for the day.")}
			[/else]
		)}
	[/event]
	
	[event]
		name=Pema_conversation_work
		id=Pema_conversation_work
		first_time_only=no
		[fire_event]
			name=Voadar_remembers_farmers
			# Voadar_remembers_farmers has first_time_only=yes, 
			# so this tag only does something if the player hasn't met the farmers yet
		[/fire_event]
		{VOADAR_MESSAGE Pema (_"How are you, Voadar? We're finishing up the day's work, so soon we'll be heading inside for the night. Could we wait to chat until then?")}
	[/event]
	
	[event]
		name=Pema_conversation_after_work
		id=Pema_conversation_after_work
		first_time_only=no
		[fire_event]
			name=Voadar_remembers_farmers
			# Voadar_remembers_farmers has first_time_only=yes, 
			# so this tag only does something if the player hasn't met the farmers yet
		[/fire_event]
		{VOADAR_MESSAGE Pema (_"Come on, kids! That's enough for today. Time to get you in bed. Now where's Todd? I'd better clean him off, he always gets so muddy.")}
		[if]
			[have_unit]
				id=Todd
				[filter_vision]
					visible=yes
					side=1
				[/filter_vision]
			[/have_unit]
			[then]
				{VOADAR_MESSAGE Todd (_"No! I like mud!")}
				[store_unit]
					[filter]
						id=Todd
					[/filter]
					variable=farmers.temp_todd
				[/store_unit]
				{VOADAR_MESSAGE Pema (_"Come here and stop wiggling!")}
				{MOVE_UNIT (id=Pema) $farmers.temp_todd.x| $farmers.temp_todd.y|}
				{CLEAR_VARIABLE farmers.temp_todd}
			[/then]
		[/if]
	[/event]
	
	[event]
		name=Pema_conversation_union
		id=Pema_conversation_union
		first_time_only=no
		[fire_event]
			name=Voadar_remembers_farmers
			# Voadar_remembers_farmers has first_time_only=yes, 
			# so this tag only does something if the player hasn't met the farmers yet
		[/fire_event]
		{VOADAR_MESSAGE Pema (_"Todd! Don't pick your nose in public! I mean, don't do it at all, but--NO! Don't wipe it there! Come here!")}
	[/event]
	
	# this is called when the farmers lock up the house for the day. basically, they kick you out.
	# the unit that should speak is passed as the primary unit
	[event]
		name=farmers_lock_up
		id=farmers_lock_up
		first_time_only=no
		{VARIABLE farmers.locked_barn yes}
		[if]
			[have_unit]
				id=$unit.id|
				[filter_vision]
					side=1
				[/filter_vision]
			[/have_unit]
			[then]
				[message]
					# of course, really the speaker is always pema. we're use the primary_unit thing
					# in case she is speaking from inside the cart:
					caption=_"Pema"
					speaker=$unit.id|
					message=_"Oh Voadar, we're locking up the barn for the day. You'll have to come out with us, or you'll be stuck inside all day."
				[/message]
				{MOVE_UNIT (id=Voadar) 72 35}
				[fire_event]
					name=moveto
					[primary_unit]
						id=Voadar
					[/primary_unit]
				[/fire_event]
				{MOVE_UNIT (id=Voadar) 78 42}
			[/then]
		[/if]
	[/event]
	
	# since the rules for when Voadar can go into the barn house are a bit complicated,
	# we handle it all here:
	[event]
		name=moveto
		id=try_to_enter_barn
		first_time_only=no
		[filter]
			id=Voadar
			x,y=78,41
		[/filter]
		# first, if the barn isn't locked, you can go right in:
		{IF_VAR farmers.locked_barn equals no (
			[then]
				{TELEPORT_UNIT (id=Voadar) 73 24}
				[fire_event]
					name=moveto
					[primary_unit]
						id=Voadar
					[/primary_unit]
				[/fire_event]
				[return]
				[/return]
			[/then]
		)}
		# otherwise, it depends on if the farmers are in sight:
		[if]
			[have_unit]
				id=Vyncent,Pema,farmer_cart_occupied
				[filter_vision]
					side=1
					visible=yes
				[/filter_vision]
			[/have_unit]
			[then]
				{VOADAR_MESSAGE_NARRATOR (_"The barn-house is locked up for the day. If you were desperate, you definitely could break in, but that wouldn't be a good idea while any of its owners are nearby.")}
			[/then]
			[else]
				[message]
					speaker=narrator
					image=wesnoth-icon.png
					message=_"The barn-house is locked up for the day, but you almost certainly could break in, since no one is watching. Would you like to try?"
					[option]
						label=_"Yes, break into the barn-house"
						[command]
							{TELEPORT_UNIT (id=Voadar) 73 24}
							[fire_event]
								name=moveto
								[primary_unit]
									id=Voadar
								[/primary_unit]
							[/fire_event]
							{VOADAR_MESSAGE_NARRATOR (_"You found a few loose boards that you could pull free without damaging them. Now that you've slipped through the gap, you patch the fense back together. No one will ever know what you did... hopefully.")}
						[/command]
					[/option]
					[option]
						label=_"No, I'll leave it alone"
					[/option]
				[/message]
			[/else]
		[/if]
	[/event]
	
	# You can help out with the mud:
	[event]
		name=moveto
		id=clean_up_mud
		first_time_only=no
		[filter]
			id=Voadar
			[filter_location]
				x=88-97
				y=40-45
				terrain=Sm
			[/filter_location]
		[/filter]
		{VARIABLE Voadar.bool_message (_"It looks like the irrigation ditch isn't deep enough here, so it easily gets blocked up with mud or debris. Spend an hour (one turn) fixing it up?")}
		[fire_event]
			name=Voadar_bool_responds
		[/fire_event]
		{IF_VAR Voadar.bool_response equals yes (
			[then]
				[modify_unit]
					[filter]
						id=Voadar
					[/filter]
					moves=0
				[/modify_unit]
				[terrain]
					[and]
						[filter]
							id=Voadar
						[/filter]
						radius=1
					[/and]
					[and]
						terrain=Sm
					[/and]
					terrain=Wwf
				[/terrain]
			[/then]
		)}
		[if]
			[have_location]
				x=88-97
				y=40-45
				terrain=Sm
				count=0
			[/have_location]
			[then]
				# if you've cleared up all the mud, there are some significant changes to Vyncent's schedule:
				{VARIABLE Vyncent.mud_is_finished yes}
				{VOADAR_REMOVE_EVENT clean_up_mud}
				{VOADAR_REMOVE_EVENT farmer_parents_conversation_night}
				{VOADAR_REMOVE_EVENT Vyncent_conversation_work}
				{VOADAR_REMOVE_EVENT Vyncent_conversation_mud}
				{IF_VAR Vyncent.conversation equals Vyncent_conversation_mud (
					[then]
						{MOVE_UNIT (id=Vyncent) 90 43}
						{VARIABLE Vyncent.conversation Vyncent_conversation_work}
					[/then]
				)}
				[event]
					name=Vyncent_conversation_work
					id=Vyncent_conversation_work
					first_time_only=no
					{VOADAR_MESSAGE Vyncent (_"<i>(As usual, he's too busy working to notice you. Unusually, however, he isn't grumbling under his breath.)</i>")}
					[fire_event]
						name=Voadar_responds
					[/fire_event]
					[switch]
						variable=Voadar.response
						[case]
							value=3
							[return]
							[/return]
						[/case]
						[case]
							value=4
							{VOADAR_MESSAGE Vyncent (_"YEEAAAaaa...")}
							{VOADAR_MESSAGE Vyncent (_". . .")}
							{VOADAR_MESSAGE Vyncent (_"Why do you do this to me?")}
						[/case]
						[else]
							{VOADAR_MESSAGE Vyncent (_"Hm? Oh, hello, you. Listen, I really do appreciate your help in the ditch, but there's still plenty of work to keep me busy here. $d|Stop by tonight$b| or something.")}
						[/else]
					[/switch]
				[/event]
				[event]
					name=farmer_parents_conversation_night
					id=farmer_parents_conversation_night
					first_time_only=no
					{VOADAR_MESSAGE Vyncent (_"Anyway, as I was saying, I've had just about enough of those ridiculous ta-")}
					{VOADAR_MESSAGE Pema (_"Oh, Voadar is here! Good to see you again. I hear you were a big hand in our irrigation canal!")}
					{VOADAR_MESSAGE Vyncent (_". . . <i>(Sigh)</i>")}
					[fire_event]
						name=Voadar_responds
					[/fire_event]
					{IF_VAR Voadar.response equals 1 (
						[then]
							{VOADAR_MESSAGE Pema (_"Vyncent's been struggling with that for weeks, you've really saved us some trouble! Here, I have something for you.")}
						[/then]
						[else]
							{VOADAR_MESSAGE Pema (_"Don't be modest, Vyncent's been struggling with that for weeks! You've really saved us some trouble! Here, I have something for you.")}
						[/else]
					)}
					{MOVE_UNIT (id=Pema) 71 27}
					[delay]
						time=200
					[/delay]
					{MOVE_UNIT (id=Pema) 69 28}
					{VOADAR_MESSAGE Vyncent (_"But dear! That's m-")}
					{VOADAR_MESSAGE Pema (_"Oh hush, you never use it anyway. Voadar, you must get cold sometimes, wandering around outside at night as much as you do. Here, just drape this big blanket around you shoulders like this, it should keep you nice and warm.")}
					[message]
						speaker=narrator
						image=icons/cloak_leather_brown.png
						message=_"It's not much to look at, but this old blanket can help you stay warm in a pinch. Cold resistance increased by 15%!"
					[/message]
					[modify_unit]
						[filter]
							id=Voadar
						[/filter]
						[effect]
							apply_to=resistance
							replace=no
							[resistance]
								cold=-15%
							[/resistance]
						[/effect]
					[/modify_unit]
					# of course this conversation can only happen once, you don't get infinite free blankets.
					{VOADAR_REMOVE_EVENT farmer_parents_conversation_night}
					[event]
						name=farmer_parents_conversation_night
						id=farmer_parents_conversation_night
						first_time_only=no
						{VOADAR_MESSAGE Vyncent (_"As I was saying! These taxes are absolutely absurd! Voadar, even you and Cadameron must have had a hard time getting by with that aweful $d|mayor$b| stealing all your money!")}
						[fire_event]
							name=Voadar_responds
						[/fire_event]
						[switch]
							variable=Voadar.response
							[case]
								value=4
								{VOADAR_MESSAGE Pema (_"Be careful what you say, you two... you never know when $d|Dogifforo$b| is spying...")}
							[/case]
							[else]
								{VOADAR_MESSAGE Pema (_"Dear, be careful what you say... you never know when $d|Dogifforo$b| is spying...")}
							[/else]
						[/switch]
						{IF_VAR Dogifforo.alive equals yes (
							[then]
								{VOADAR_MESSAGE Vyncent (_"<i>(Shivers)</i> Ain't that the truth. Heaven only knows where the mayor dug up such an evil man to do his dirty work...")}
							[/then]
							[else]
								{VOADAR_MESSAGE Vyncent (_"<i>(Shivers)</i> Ain't that the truth. Haven't seen him in a while, but that just makes it worse... heaven only knows where the mayor dug up such an evil man to do his dirty work.")}
							[/else]
						)}
						
					[/event]
				[/event]
			[/then]
		[/if]
	[/event]
	
	[event]
		name=start
		id=farmers_prepare_variables
		[store_unit]
			[filter]
				id=farmer_cart
			[/filter]
			variable=farmers.cart
		[/store_unit]
		[unit]
			type=Cart
			id=farmer_cart_occupied
			name=$farmers.cart.name|
			x,y=$farmers.cart.x|,$farmers.cart.y|
			side=2
			variation=occupied
			to_variable=farmers.cart_occupied
		[/unit]
		{VOADAR_ADD_ITEMS Vyncent {VYNCENT_ITEM_LIST}}
		{VARIABLE farmer_cart_occupied.conversation farmer_cart_occupied_conversation}
		{VARIABLE Vyncent.conversation Vyncent_conversation_mud}
		{VARIABLE Pema.conversation Pema_conversation_launch_ants}
		{VARIABLE farmers.locked_barn yes}
		{VARIABLE Pema.Voadar_has_played_ants no}
		{VARIABLE Vyncent.mud_is_finished no}
		{VARIABLE Vyncent.shown_item_count 0}
		[event]
			name=new turn
			{VOADAR_FILTER_VARIABLE schedule.hour 10}
			{IF_VAR Pema.mini_game_is_going equals no (
				[then]
					{VARIABLE Pema.conversation Pema_conversation_work}
				[/then]
			)}
		[/event]
	[/event]
	
	[event]
		name=new turn
		id=Vyncent_sends_the_cow_out
		first_time_only=no
		[filter_condition]
			[have_unit]
				id=Vyncent
				[filter_vision]
					side=1
				[/filter_vision]
			[/have_unit]
			[have_unit]
				id=farm_cow
				[filter_location]
					terrain=Ior,Ior^*,Iwr,Iwr^*
				[/filter_location]
			[/have_unit]
		[/filter_condition]
		{VOADAR_MESSAGE Vyncent (_"Oh, for the love of... Pema, someone's let the cow into the house <i>again.</i>")}
		{VOADAR_STORE_UNIT Vyncent no}
		{VOADAR_STORE_UNIT farm_cow no}
		{VARIABLE Vyncent.to_x $farm_cow.unit.x|}
		{VARIABLE Vyncent.to_y $farm_cow.unit.y|}
		{VARIABLE_OP Vyncent.to_y add 1}
		{MOVE_UNIT id=Vyncent $Vyncent.to_x| $Vyncent.to_y|}
		{MOVE_UNIT id=farm_cow 71 32}
		{MOVE_UNIT id=Vyncent $Vyncent.unit.x| $Vyncent.unit.y|}
		{CLEAR_VARIABLE farm_cow}
	[/event]
	
	{VOADAR_CHEST 75 28 common}
	
	{VOADAR_CREATE_CONVERSATION_OPTION Vyncent}
	{VOADAR_CREATE_CONVERSATION_OPTION Pema}
	{VOADAR_CREATE_CONVERSATION_OPTION farmer_cart_occupied}
	
	[event]
		name=victory
		id=farmers_clear_variables
		{CLEAR_VARIABLE farmers}
		{CLEAR_VARIABLE Pema}
		{CLEAR_VARIABLE Vyncent}
		{CLEAR_VARIABLE farmer_cart_occupied}
	[/event]
	
	########################################
	# Reactions to shown items begin here
	########################################
	
	[event]
		name=show_letter
		id=Vyncent_show_letter
		first_time_only=no
		{VOADAR_SHOW_ITEM_FILTER Vyncent}
		{VOADAR_MESSAGE Vyncent (_"Hm, is that for me? Lemme see it...")}
		{VOADAR_MESSAGE Vyncent (_"<i>(Goes a little white, and hushes his voice)</i> Oh no... Pema's mother is still trying to schedule a visit. Have to think of an excuse for next weekend...")}
		{VOADAR_MESSAGE Vyncent (_"<i>(Scribbles a quick letter)</i> Hopefully that will work... And don't breathe a word about this to my wife!")}
	[/event]
	[event]
		name=show_letter
		id=Pema_show_letter
		first_time_only=no
		{VOADAR_SHOW_ITEM_FILTER Pema}
		{VOADAR_MESSAGE Pema (_"Oh, is that a letter for us? Thanks for delivering it!")}
		{VOADAR_MESSAGE Pema (_"Oh, it's from Vyncent's sister. She's such a sweet woman. <i>(Writes a quick response)</i> Here, would you make sure this gets sent back to her?")}
	[/event]
	
	[event]
		name=show_hat
		id=Vyncent_show_hat
		first_time_only=no
		{VOADAR_SHOW_ITEM_FILTER Vyncent}
		{VOADAR_MESSAGE Vyncent (_"Oh, what do you want n--")}
		{VOADAR_MESSAGE Vyncent (_"Oh. So don't know what happened.")}
		{IF_VAR Vyncent.mud_is_finished equals no (
			[then]
				{VOADAR_MESSAGE Vyncent (_"Listen, Cadameron and I never really got along, but there was one thing we saw eye-to-eye on. Neither of us could stand... <i>(Looks at the blood stained hat again)</i>")}
				{VOADAR_MESSAGE Vyncent (_"<i>(Avoids eye contact)</i> ...Neither of us could stand pointless talk when there's work to be done.")}
				[fire_event]
					name=Voadar_responds
				[/fire_event]
				[switch]
					variable=Voadar.response
					[case]
						value=2,4
						{VOADAR_MESSAGE Vyncent (_"Oh, don't give me that... look, I've got things to live for, alright? Who cares about some measly taxes anyway?")}
					[/case]
					[case]
						value=3
						{VOADAR_MESSAGE Vyncent (_"<i>(Looks guilty)</i> Look, I've got things to live for, alright? Who cares about some measly taxes anyway?")}
					[/case]
				[/switch]
			[/then]
			[else]
				{VOADAR_MESSAGE Vyncent (_"Listen, I guess I've misjudged you a little. Whatever else, you have been a big help here, and you know better than anyone how much trouble that mayor has become.")}
				{VOADAR_MESSAGE Vyncent (_"I... don't want to end up like Cadameron. I have a lot to live for. But if you ever want to make a move against the mayor... count me in.")}
			[/else]
		)}
	[/event]
	
	[event]
		name=Vyncent_sees_an_item
		id=Vyncent_sees_an_item
		first_time_only=no
		[fire_event]
			name=Voadar_remembers_farmers
		[/fire_event]
		[switch]
			variable=Vyncent.shown_item_count
			[case]
				value=0
				{VOADAR_MESSAGE Vyncent (_"Hm? You need something?")}
			[/case]
			[case]
				value=1
				{VOADAR_MESSAGE Vyncent (_"You again? Alright, what is it now?")}
			[/case]
			[case]
				value=2
				{VOADAR_MESSAGE Vyncent (_"...Let me guess, there's something you want to show me.")}
			[/case]
			[case]
				value=3
				{VOADAR_MESSAGE Vyncent (_". . .")}
			[/case]
			[case]
				value=4
				{VOADAR_MESSAGE Vyncent (_"Don't you have something better to spend your time on than this?")}
			[/case]
			[case]
				value=5
				{VOADAR_MESSAGE Vyncent (_"Voadar! I have things to do! Could you just... augh! <i>(Imitates Pema's voice:)</i> 'Dear, Voadar is a friend! You should always treat him <span size='small'>blah blah blah...</span>' Alright, fine! What is it this time!")}
			[/case]
			[else]
				{VOADAR_MESSAGE Vyncent (_"<i>(Twitching slightly)</i> Yes, friend Voadar?")}
			[/else]
			[case]
				value=10
				{VOADAR_MESSAGE Vyncent (_"...Is it your life goal to make sure I never have time to achive mine?")}
			[/case]
		[/switch]
		{VARIABLE_OP Vyncent.shown_item_count add 1}
	[/event]
	
	[event]
		name=show_earmuffs
		id=Vyncent_show_earmuffs
		first_time_only=no
		{VOADAR_SHOW_ITEM_FILTER Vyncent}
		[fire_event]
			name=Vyncent_sees_an_item
		[/fire_event]
		{VOADAR_MESSAGE Vyncent (_"A pair of earmuffs?")}
		{VOADAR_MESSAGE Vyncent (_"Looks very cozy. Maybe if I was wearing a pair, I couldn't hear you and could focus on getting some work done.")}
	[/event]
	[event]
		name=show_bear_claws
		id=Vyncent_show_bear_claws
		first_time_only=no
		{VOADAR_SHOW_ITEM_FILTER Vyncent}
		[fire_event]
			name=Vyncent_sees_an_item
		[/fire_event]
		{VOADAR_MESSAGE Vyncent (_"Some bear claws?")}
		{VOADAR_MESSAGE Vyncent (_"Very nice. I wonder if bears have as many pointless trinkets to show off as drakes do.")}
	[/event]
	[event]
		name=show_charm
		id=Vyncent_show_charm
		first_time_only=no
		{VOADAR_SHOW_ITEM_FILTER Vyncent}
		[fire_event]
			name=Vyncent_sees_an_item
		[/fire_event]
		{VOADAR_MESSAGE Vyncent (_"What even is that?")}
		{VOADAR_MESSAGE Vyncent (_"Seriously, what is the point of a shiny, carved up rock on a chain? I'm amazed people spend money on those. And even more amazed that some people would rather stand around talking about them than resume their farming.")}
	[/event]
	[event]
		name=show_net
		id=Vyncent_show_net
		first_time_only=no
		{VOADAR_SHOW_ITEM_FILTER Vyncent}
		[fire_event]
			name=Vyncent_sees_an_item
		[/fire_event]
		{VOADAR_MESSAGE Vyncent (_"A fishing net?")}
		{VOADAR_MESSAGE Vyncent (_"Why don't you try fishing in our little pond over there? I'm sure it's just <i>swarming</i> with fish. In fact, why don't you leave me in peace until you catch one in it?")}
	[/event]
	[event]
		name=show_meat
		id=Vyncent_show_meat
		first_time_only=no
		{VOADAR_SHOW_ITEM_FILTER Vyncent}
		[fire_event]
			name=Vyncent_sees_an_item
		[/fire_event]
		{VOADAR_MESSAGE Vyncent (_"A... bit of meat?")}
		{VOADAR_MESSAGE Vyncent (_"...What on earth makes you think I'd want to take time out of my day to look at <i>this?</i>")}
	[/event]
	[event]
		name=show_ale
		id=Vyncent_show_ale
		first_time_only=no
		{VOADAR_SHOW_ITEM_FILTER Vyncent}
		[fire_event]
			name=Vyncent_sees_an_item
		[/fire_event]
		{VOADAR_MESSAGE Vyncent (_"A mug of ale, I see.")}
		{VOADAR_MESSAGE Vyncent (_"Well, isn't it nice to know that you have enough free time to get drunk at this hour. I, on the other hand, have work to do. So perhaps I could get a bit of peace and quiet?")}
	[/event]
	[event]
		name=show_sword
		id=Vyncent_show_sword
		first_time_only=no
		{VOADAR_SHOW_ITEM_FILTER Vyncent}
		[fire_event]
			name=Vyncent_sees_an_item
		[/fire_event]
		{VOADAR_MESSAGE Vyncent (_"A sword?")}
		{VOADAR_MESSAGE Vyncent (_"You want me to drop everything I'm doing to look at a bit of pointy metal?")}
		{VOADAR_MESSAGE Vyncent (_". . .")}
		{VOADAR_MESSAGE Vyncent (_"Ooh, Voadar! Look over there! A blade of <i>grass!</i> Why don't you go scrutinize its details, while I get on with my day?")}
	[/event]
	[event]
		name=show_herb_bag
		id=Vyncent_show_herb_bag
		first_time_only=no
		{VOADAR_SHOW_ITEM_FILTER Vyncent}
		[fire_event]
			name=Vyncent_sees_an_item
		[/fire_event]
		{VOADAR_MESSAGE Vyncent (_". . .")}
		{VOADAR_MESSAGE Vyncent (_"They're herbs. From our farm. They taste great. What more do you want from me?")}
	[/event]
	
	[event]
		name=show_hat
		id=Pema_show_hat
		first_time_only=no
		{VOADAR_SHOW_ITEM_FILTER Pema}
		{VOADAR_MESSAGE Pema (_"Oh dear, you poor thing. It really is aweful that this kind of thing could happen. I keep telling Vyncent to be careful, but sometimes he makes me worry...")}
	[/event]
	[event]
		name=show_herb_bag
		id=Pema_show_herb_bag
		first_time_only=no
		{VOADAR_SHOW_ITEM_FILTER Pema}
		{VOADAR_MESSAGE Pema (_"Have you been enjoying those herbs?")}
		{VARIABLE Voadar.bool_message (_"Have you been enjoying Pema's herbs?")}
		[fire_event]
			name=Voadar_bool_responds
		[/fire_event]
		{IF_VAR Voadar.bool_response equals yes (
			[then]
				{VOADAR_MESSAGE Pema (_"Glad to hear it! You know, we actually make quite a good $d|profit$b| on those, with the right buyer.")}
			[/then]
			[else]
				{VOADAR_MESSAGE Pema (_"Oh, you don't care for the flavor? In that case, would you mind sharing some with those $d|tourist boys?$b| They just love this mix.")}
			[/else]
		)}
	[/event]
	[event]
		name=show_charm
		id=Pema_show_charm
		first_time_only=no
		{VOADAR_SHOW_ITEM_FILTER Pema}
		{VOADAR_MESSAGE Pema (_"Wow, now that is just beautiful! It's elvish, right? That must be worth a lot of money.")}
	[/event]
	[event]
		name=show_net
		id=Pema_show_net
		first_time_only=no
		{VOADAR_SHOW_ITEM_FILTER Pema}
		{VOADAR_MESSAGE Pema (_"Say, that looks just like Juditha's fishing net. It's a good one, that's for sure. Have you fished much?")}
		{VARIABLE Voadar.bool_message (_"Have you tried fishing very much?")}
		[fire_event]
			name=Voadar_bool_responds
		[/fire_event]
		{IF_VAR Voadar.bool_response equals yes (
			[then]
				{VOADAR_MESSAGE Pema (_"You're probably better at it than us, then. We go out with Juditha and her daughter a few times every year, and I learn something new about it every time.")}
			[/then]
			[else]
				{VOADAR_MESSAGE Pema (_"Well if you do try, be sure to do it in $d|open water.$b| We usually stick to very shallow places like fords because it's easier for the kids, but when Vyncent and I go alone and wade out to our hips we have much better luck.")}
			[/else]
		)}
	[/event]
	[event]
		name=show_meat
		id=Pema_show_meat
		first_time_only=no
		{VOADAR_SHOW_ITEM_FILTER Pema}
		{VOADAR_MESSAGE Pema (_"Is that beef? Vyncent and I always wanted to keep some cattle, but until the kids get older we just have one milk cow.")}
	[/event]

	
	########################################
	# Standard unit data begins here
	########################################
    id=Seasoned Farmer
    name= _ "Seasoned Farmer"
    race=human
	gender=male,female
    image="units/human-peasants/farmer.png"
    profile="portraits/humans/peasant.png"
    {MAGENTA_IS_THE_TEAM_COLOR}
    hitpoints=48
    movement_type=smallfoot
    movement=6
    experience=100
	level=1
	upkeep=loyal
    alignment=lawful
    advances_to=null
    {AMLA_DEFAULT}
    cost=25
    usage=fighter
    description= _ ""+{SPECIAL_NOTES}+{SPECIAL_NOTES_FIRSTSTRIKE}
    die_sound={SOUND_LIST:HUMAN_DIE}
    {DEFENSE_ANIM "units/human-peasants/farmer-defend.png" "units/human-peasants/farmer.png" {SOUND_LIST:HUMAN_HIT}}
    [portrait]
        size=400
        side="left"
        mirror="false"
        image="portraits/humans/javelineer.png"
    [/portrait]
    [portrait]
        size=400
        side="right"
        mirror="true"
        image="portraits/humans/javelineer.png"
    [/portrait]
    [resistance]
        pierce=60
    [/resistance]
    [attack]
        name=spear
        description=_"pitchfork"
		icon=attacks/pitchfork.png
        type=pierce
        range=melee
        damage=7
        number=3
        [specials]
            {WEAPON_SPECIAL_FIRSTSTRIKE}
        [/specials]
    [/attack]
    [attack]
        name=javelin
        description=_"pitchfork"
        icon=attacks/pitchfork.png
        type=pierce
        range=ranged
        damage=9
        number=2
    [/attack]
    [attack_anim]
        [filter_attack]
            name=javelin
        [/filter_attack]
        missile_start_time=0
        [missile_frame]
            duration=150
            image="projectiles/spear-n.png"
            image_diagonal="projectiles/spear-ne.png"
        [/missile_frame]
        start_time=-250
        attack_sound_start_time=-50
        [attack_sound_frame]
            duration=100
            sound={SOUND_LIST:THROW}
        [/attack_sound_frame]
        [if]
            hits=yes
            [attack_sound_frame]
                sound=spear.ogg
            [/attack_sound_frame]
        [/if]
    [/attack_anim]
    [attack_anim]
        [filter_attack]
            name=spear
        [/filter_attack]
        start_time=-300
        [frame]
            image="units/human-peasants/farmer-attack-[1~3].png:[100*2,200]"
        [/frame]
        {SOUND:HIT_AND_MISS spear.ogg spear-miss.ogg -100}
        [frame]
            image="units/human-peasants/farmer-attack-1.png:125"
        [/frame]
        [frame]
            image="units/human-peasants/farmer.png:75"
        [/frame]
    [/attack_anim]
	[female]
        name= _ "female^Seasoned Farmer"
        gender=female
        image="units/human-peasants/peasant+female.png"
        profile="portraits/peasant_woman.png"
		die_sound={SOUND_LIST:HUMAN_FEMALE_DIE}
		{DEFENSE_ANIM "units/human-peasants/peasant+female-defend.png" "units/human-peasants/peasant+female-defend.png" {SOUND_LIST:HUMAN_FEMALE_HIT}}
        [portrait]
            size=400
            side="left"
            mirror="false"
            image="portraits/peasant_woman.png"
        [/portrait]
        [portrait]
            size=400
            side="right"
            mirror="true"
            image="portraits/peasant_woman.png"
        [/portrait]
		[attack_anim]
			[filter_attack]
				name=spear
			[/filter_attack]
			start_time=-300
			[frame]
				image="units/human-peasants/peasant+female-attack-[1~2].png:[200,200]"
			[/frame]
			[frame]
				image="units/human-peasants/peasant+female-attack-1.png:125"
			[/frame]
			[frame]
				image="units/human-peasants/peasant+female.png:75"
			[/frame]
		[/attack_anim]
	[/female]
[/unit_type]

#undef VYNCENT_ITEM_LIST
