#textdomain wesnoth-voadar
[scenario]
    
    id=4_Vengeance
    name= _ "Vengeance"
    next_scenario=null
    map_data="{~add-ons/Voyage_of_a_Drake/maps/vengeance.map}"
    turns=-1
    victory_when_enemies_defeated=no
	
	# TODO
    {INTRO_AND_SCENARIO_MUSIC underground.ogg silence.ogg}
	
    [story]
        [part]
            story= _ "A cheer broke out as the last soldiers fled, but the rejoicing didn't last long. There were dead to bury and injuries to treat, and most of all, plans to make. Voadar's friends agreed that such unreasonable behavior from the royal army was unusual; without a doubt, it was Mayor Ronry who had incited the attack. With that in mind, it seemed likely that he had already slipped out of town, but just in case, Voadar went to search the town hall while the others bandaged wounds."
            background="story/landscape-hills-01.jpg"
        [/part]
    [/story]
	
	# Set the objectives
#define VENGEANCE_OBJECTIVES EXTRA_NOTE
	[objectives]
		[objective]
			description= _ "Bring Mayor Ronry to justice"
			condition=win
		[/objective]
		[objective]
			description=_"Death of Voadar"
			condition=lose
		[/objective]
		[note]
			description=_"Voadar has triple his normal HP"
		[/note]
		[note]
			description=_"In the heat of battle, you don't have time to use any items"
		[/note]
		{EXTRA_NOTE}
	[/objectives]
#enddef
    [event]
        name=prestart
		{IF_VAR Voadar.has_potion equals yes (
			[then]
				{VENGEANCE_OBJECTIVES (
					[note]
						description=_"However, the instant heal potion you bought from Klippy is still available"
					[/note]
				)}
			[/then]
			[else]
				{VENGEANCE_OBJECTIVES ()}
			[/else]
		)}
    [/event]
#undef VENGEANCE_OBJECTIVES
	
	# schedule
	{INDOORS}

    # The player's side
    [side]
        {VOADAR_SIDE_BASICS}
        side=1
        controller=human
        gold=0
        shroud=yes
		fog=no
        team_name=raplice
        color=orange
        {FLAG_VARIANT loyalist}
    [/side]
	
    # Enemy's side
    [side]
        {VOADAR_SIDE_BASICS}
        side=2
        team_name=foes
        color=purple
        shroud=no
		fog=no
        gold=500
        [ai]
			passive_leader=yes
            aggression=.9
            caution=.35
            [goal]
                [criteria]
                    side=1
                [/criteria]
                value=.9
            [/goal]
        [/ai]
        {FLAG_VARIANT loyalist}
    [/side]
	
	# No such thing as upkeep, as usual
	[event]
		name=unit placed
		id=units_are_healable
		first_time_only=no
		[modify_unit]
			[filter]
				x,y=$x1,$y1
			[/filter]
			upkeep=loyal
			# and just in case:
			[status]
                unhealable=no
				poisoned=no
				slowed=no
            [/status]
		[/modify_unit]
		# MAYBE IMPORTANT NOTE:
		# I'm not removing the doubled hp from the last scenario
		# because I still want Voadar to have double hp
		# I'm pretty sure I'll never carry over other units from the previous 
		# scenario, but if I do I'll have to decide whether or not their hp 
		# should be put back to normal
	[/event]
	
# Throughout the course of this scenario, there will be
# multiple versions of Ronry
#define VOADAR_RONRY NAME VARIATION
	[unit]
		id=Ronry
		name={NAME}
		x,y=19,5
		type=Voadar Mayor
		side=2
		facing=sw
		variation={VARIATION}
		random_traits=no
		canrecruit=yes
	[/unit]
#enddef

# Also, when spells/effects need to look powerful:
#define VOADAR_SPELL WML
	[modify_unit]
		[filter]
			id=Ronry
		[/filter]
		halo=halo/illuminates-aura.png
	[/modify_unit]
	[sound]
		name=rumble.ogg
	[/sound]
	[delay]
		time=200
	[/delay]
	[set_variable]
		name=Ronry.rando
		rand=1..3
	[/set_variable]
	[switch]
		variable=Ronry.rando
		[case]
			value=1
			{FLASH_RED (
				[delay]
					time=50
				[/delay]
			)}
		[/case]
		[case]
			value=2
			{FLASH_BLUE (
				[delay]
					time=50
				[/delay]
			)}
		[/case]
		[case]
			value=3
			{FLASH_GREEN (
				[delay]
					time=50
				[/delay]
			)}
		[/case]
	[/switch]
	[delay]
		time=200
	[/delay]
	{THUNDER (
		[delay]
			time=50
		[/delay]
		{WML}
		[redraw]
		[/redraw]
		[delay]
			time=50
		[/delay]
	)}
	[delay]
		time=200
	[/delay]
	[set_variable]
		name=Ronry.rando
		rand=1..3
	[/set_variable]
	[switch]
		variable=Ronry.rando
		[case]
			value=1
			{FLASH_RED (
				[delay]
					time=50
				[/delay]
			)}
		[/case]
		[case]
			value=2
			{FLASH_BLUE (
				[delay]
					time=50
				[/delay]
			)}
		[/case]
		[case]
			value=3
			{FLASH_GREEN (
				[delay]
					time=50
				[/delay]
			)}
		[/case]
	[/switch]
	[sound]
		name=rumble.ogg
	[/sound]
	[delay]
		time=200
	[/delay]
	[modify_unit]
		[filter]
			id=Ronry
		[/filter]
		halo=""
	[/modify_unit]
#enddef

# and this little one is convenient for creating minions
#define VOADAR_ANIMATE_IN
	[+unit]
		animate=yes
	[/unit]
#enddef
	
	[event]
		name=prestart
		
		# you quietly get an hp boost on top of the previous level's
		{VARIABLE_OP Voadar.unit.hitpoints multiply 1.5}
		{VARIABLE_OP Voadar.unit.max_hitpoints multiply 1.5}
		
		# Place units
		[unstore_unit]
			variable=Voadar.unit
			x,y=5,8
		[/unstore_unit]
		{VOADAR_RONRY (_"Clarice") clarice}
		# At first, he's still pretending he's not himself
		[modify_unit]
			[filter]
				x,y=19,5
			[/filter]
			name=_"Clarice"
		[/modify_unit]
		
		# Also, there are some variables to prepare, to assist
		# in randomly choosing magic attacks later
	
		{VARIABLE Ronry.magic_attacks[0].name "fireball"}
		{VARIABLE Ronry.magic_attacks[0].type fire}
		{VARIABLE Ronry.magic_attacks[0].damage 10}
		{VARIABLE Ronry.magic_attacks[0].number 1}
		
		{VARIABLE Ronry.magic_attacks[1].name "mud glob"}
		{VARIABLE Ronry.magic_attacks[1].type impact}
		{VARIABLE Ronry.magic_attacks[1].damage 10}
		{VARIABLE Ronry.magic_attacks[1].number 1}
		
		{VARIABLE Ronry.magic_attacks[2].name "faerie fire"}
		{VARIABLE Ronry.magic_attacks[2].type arcane}
		{VARIABLE Ronry.magic_attacks[2].damage 10}
		{VARIABLE Ronry.magic_attacks[2].number 1}
		
		{VARIABLE Ronry.magic_attacks[3].name "chill tempest"}
		{VARIABLE Ronry.magic_attacks[3].type cold}
		{VARIABLE Ronry.magic_attacks[3].damage 10}
		{VARIABLE Ronry.magic_attacks[3].number 1}
	[/event]
	
	[event]
		name=moveto
		id=enter_basement
		[filter]
			id=Voadar
			x,y=4,3
		[/filter]
		# Entering the basement is what kicks things off

		{TELEPORT_UNIT (id=Voadar) 10 5}
		[place_shroud]
			side=1
			x=0-8
		[/place_shroud]
		{MOVE_UNIT (id=Voadar) 12 5}
		[modify_unit]
			[filter]
				id=Voadar
			[/filter]
			moves=0
		[/modify_unit]
		
		[delay]
			time=800
		[/delay]
		{VOADAR_MESSAGE_RIGHT Ronry (_"You just couldn't make an appointment, could you?")}
		
		# This is the main scenario music:
		{REPLACE_SCENARIO_MUSIC casualties_of_war.ogg}
		{APPEND_MUSIC weight_of_revenge.ogg}
		{APPEND_MUSIC siege_of_laurelmor.ogg}
		{APPEND_MUSIC northern_mountains.ogg}
		
		[delay]
			time=100
		[/delay]
		[sound]
			name=drake-hit-1.ogg
		[/sound]
		[animate_unit]
			flag=leading
			[filter]
				id=Voadar
			[/filter]
			[facing]
				[filter]
					id=Ronry
				[/filter]
			[/facing]
		[/animate_unit]
		{VOADAR_MESSAGE_RIGHT Ronry (_"Alright, alright. I'll stop playing games.")}
		{VOADAR_SPELL (
			[terrain]
				x,y=10,5
				terrain=Urb^Yru
			[/terrain]
		)}
		{VOADAR_MESSAGE_RIGHT Ronry (_"But if you want to meet Mayor Ronry, you'll have to get past me.")}
		
		# For the rest of the fight, he/she is pelting you with ranged spells
		[event]
			name=side 2 turn end
			id=Ronry_attacks
			first_time_only=no
			[filter_condition]
				[have_unit]
					id=Ronry
				[/have_unit]
			[/filter_condition]
			[set_variable]
				name=Ronry.attack_num
				rand=1..$Ronry.magic_attacks.length|
			[/set_variable]
			{VARIABLE_OP Ronry.attack_num sub 1}
			{VOADAR_STORE_UNIT Ronry no}
			[set_variables]
				name=Ronry.unit.attack
				mode=replace
				to_variable=Ronry.magic_attacks[$Ronry.attack_num|]
			[/set_variables]
			[unstore_unit]
				variable=Ronry.unit
			[/unstore_unit]
			[harm_unit]
				[filter]
					id=Voadar
				[/filter]
				[filter_second]
					id=Ronry
				[/filter_second]
				amount=$Ronry.magic_attacks[$Ronry.attack_num|].damage|
				damage_type=$Ronry.magic_attacks[$Ronry.attack_num|].type|
				kill=yes
				fire_event=yes
				animate=yes
				[primary_attack]
					name=$Ronry.magic_attacks[$Ronry.attack_num|].name|
				[/primary_attack]
				[secondary_attack]
					name=$Ronry.magic_attacks[$Ronry.attack_num|].name|
				[/secondary_attack]
				experience=yes
			[/harm_unit]
			{CLEAR_VARIABLE Ronry.unit.attack}
			[unstore_unit]
				variable=Ronry.unit
			[/unstore_unit]
		[/event]
		
		# The unit starts with low hp so she looks weak, but when you first
		# try to attack she quietly gets her true hp
		[event]
			name=attack
			id=Ronry_gets_hp
			[filter_second]
				id=Ronry
			[/filter_second]
			[modify_unit]
				[filter]
					id=Ronry
				[/filter]
				hitpoints=1000
				max_hitpoints=1000
			[/modify_unit]
			
			# also, after your first attack, she makes the fight a bit more interesting
			[event]
				name=new turn
				{VOADAR_MESSAGE_RIGHT Ronry (_"I suppose you still don't realize how much trouble you're in. I wonder how long it will take?")}
				{VOADAR_SPELL (
					[heal_unit]
						[filter]
							id=Voadar
						[/filter]
					[/heal_unit]
					{TELEPORT_UNIT (id=Voadar) 12 5}
					{GENERIC_UNIT 2 "Fire Spirit" 14 3}
					{GENERIC_UNIT 2 "Shadow Spirit" 14 4}
					{GENERIC_UNIT 2 "Fire Spirit" 14 5}
					{GENERIC_UNIT 2 "Shadow Spirit" 14 6}
					{GENERIC_UNIT 2 "Fire Spirit" 14 7}
				)}
			[/event]
			
			# When you get her below a certain hp:
			[event]
				name=new turn
				[filter_condition]
					[have_unit]
						id=Ronry
						formula=hitpoints <= max_hitpoints - 130
					[/have_unit]
				[/filter_condition]
				
				{VOADAR_MESSAGE_RIGHT Ronry (_"Hum. I should have known you wouldn't give up easily. Drakes really are amazing. Still...")}
				[delay]
					time=100
				[/delay]
				{VOADAR_STORE_UNIT Ronry no}
				[set_variables]
					name=Ronry.unit.attack
					mode=replace
					to_variable=Ronry.magic_attacks[3]
				[/set_variables]
				[unstore_unit]
					variable=Ronry.unit
				[/unstore_unit]
				{VOADAR_STORE_UNIT Voadar no}
				[harm_unit]
					[filter]
						id=Voadar
					[/filter]
					[filter_second]
						id=Ronry
					[/filter_second]
					amount=500
					kill=yes
					fire_event=no
					animate=yes
					[primary_attack]
						name=chill tempest
					[/primary_attack]
					[secondary_attack]
						name=chill tempest
					[/secondary_attack]
					experience=no
				[/harm_unit]
				{CLEAR_VARIABLE Ronry.unit.attack}
				[unstore_unit]
					variable=Ronry.unit
				[/unstore_unit]
				[delay]
					time=1000
				[/delay]
				{VOADAR_FACE Ronry sw}
				{VOADAR_MESSAGE_RIGHT Ronry (_"Still, you're lucky I'm not done yet.")}
				{VOADAR_SPELL (
					[kill]
						side=2
						[not]
							id=Ronry
						[/not]
					[/kill]
					{VARIABLE Voadar.unit.hitpoints $Voadar.unit.max_hitpoints|}
					[unstore_unit]
						variable=Voadar.unit
						x,y=12,5
					[/unstore_unit]
				)}
				
				# phase two starts after the next time you attack
				[event]
					name=attack
					[filter]
						id=Voadar
					[/filter]
					[event]
						name=new turn
						[fire_event]
							name=phase_two
						[/fire_event]
					[/event]
				[/event]
			[/event]
		[/event]
	[/event]
	
	[event]
		name=phase_two
		id=phase_two
		{VOADAR_MESSAGE_RIGHT Ronry (_"<i>(Breathing heavily)</i> Well, you are full of energy. Let's see how you like this.")}
		{VOADAR_SPELL (
			[heal_unit]
				[filter]
					id=Voadar
				[/filter]
			[/heal_unit]
			{TELEPORT_UNIT (id=Voadar) 12 5}
			[kill]
				id=Ronry
			[/kill]
			{VOADAR_RONRY (_"Ivan") ivan}
		)}
		{VOADAR_MESSAGE_RIGHT Ronry (_"<i>Pant</i> Recognize me? Heh, changing <i>pant</i> appearances is a tiring little spell, but an important one. I <i>pant</i> invented Ivan for keeping an eye on everyone... especially you.")}
		[event]
			name=attack
			[filter]
				id=Voadar
			[/filter]
			[event]
				name=new turn
				{VOADAR_MESSAGE_RIGHT Ronry (_"Heh heh, now when did you get such a <i>pant</i> temper, little fella? That's not how you would've treated Cadameron!")}
				{VOADAR_SPELL (
					[heal_unit]
						[filter]
							id=Voadar
						[/filter]
					[/heal_unit]
					{TELEPORT_UNIT (id=Voadar) 12 5}
				)}
				[delay]
					time=100
				[/delay]
				[sound]
					name=drake-hit-1.ogg
				[/sound]
				[animate_unit]
					flag=leading
					[filter]
						id=Voadar
					[/filter]
					[facing]
						[filter]
							id=Ronry
						[/filter]
					[/facing]
				[/animate_unit]
				{VOADAR_MESSAGE_RIGHT Ronry (_"That old simpleton. Can't imagine why you were so fond of him. After makin' sure Dogifforo had <i>pant</i> finished him off proper, I brought the guards on back to clean things up. And heh! I almost busted up laughing at how upset they were!")}
				{GENERIC_UNIT 2 "Fire Spirit" 13 4}{VOADAR_ANIMATE_IN}
				{GENERIC_UNIT 2 "Fire Spirit" 13 7}{VOADAR_ANIMATE_IN}
				{GENERIC_UNIT 2 "Fire Spirit" 14 5}{VOADAR_ANIMATE_IN}
				{GENERIC_UNIT 2 "Shadow Spirit" 16 5}{VOADAR_ANIMATE_IN}
				[delay]
					time=500
				[/delay]
				{VOADAR_SPELL (
					[terrain]
						x=16, 16
						y=3-4,6-7
						terrain=Urb^Yru
					[/terrain]
					[redraw]
					[/redraw]
				)}
				
				# He summons more spirits for the rest of the fight
				{VARIABLE Ronry.summon_x 20}
				{VARIABLE Ronry.summon_y 5}
				[event]
					name=side 2 turn refresh
					id=Ronry_summons
					first_time_only=no
					[set_variable]
						name=Ronry.rando
						rand="Fire Spirit","Shadow Spirit"
					[/set_variable]
					{GENERIC_UNIT 2 $Ronry.rando| $Ronry.summon_x| $Ronry.summon_y|}{VOADAR_ANIMATE_IN}
					[+unit]
						moves=0
						attacks_left=0
						passable=yes
					[/unit]
				[/event]
				
				[event]
					name=new turn
					[filter_condition]
						[have_unit]
							id=Ronry
							formula=hitpoints <= max_hitpoints - 85
						[/have_unit]
					[/filter_condition]
					[fire_event]
						name=phase_three
					[/fire_event]
				[/event]
			[/event]
		[/event]
	[/event]
	
	[event]
		name=phase_three
		id=phase_three
		{VOADAR_MESSAGE_RIGHT Ronry (_"Well. That's just about <i>pant</i> enough messin' around, wouldn't you say?")}
		{VOADAR_SPELL (
			[heal_unit]
				id=Voadar
			[/heal_unit]
			{TELEPORT_UNIT (id=Voadar) 12 5}
			[kill]
				side=2
				# includes Ronry
			[/kill]
			{VOADAR_RONRY (_"Ronry") ronry}
		)}
		{VOADAR_MESSAGE_RIGHT Ronry (_"<i>Pant</i> I do hope that by now you've figured out who I <i>pant</i> really am. Mayor Ronry, <i>pant</i> at your service.")}
		{VOADAR_MESSAGE_RIGHT Ronry (_"After I <i>pant</i> persuaded the town to elect me as mayor after the <i>pant</i> previous one's 'accident,' <i>pant</i> this really was an ideal setup for my research. But then you had to <i>pant</i> ruin things, so now I'll have to <i>pant</i> find someplace new. That's why...")}
		{VOADAR_SPELL (
			[terrain]
				x,y=16,5
				terrain=Wog
			[/terrain]
		)}
		[for]
			end=3
			[do]
				[delay]
					time=500
				[/delay]
				[terrain]
					[not]
						terrain=Urb^Yru,Xos
						[or]
							[filter]
								id=Ronry
							[/filter]
						[/or]
						[or]
							x=12,13,12,13
							y=3, 3, 7, 8
						[/or]
					[/not]
					[filter_adjacent_location]
						terrain=Wog
					[/filter_adjacent_location]
					terrain=Wog
				[/terrain]
				[redraw]
				[/redraw]
			[/do]
		[/for]
		{VOADAR_MESSAGE_RIGHT Ronry (_"...I'm going to <i>pant</i> make this painful for you.")}
		
		# throughout this phase, his minions have a small hp boost
		[event]
			name=unit placed
			id=stronger_spirits
			first_time_only=no
			[filter]
				side=2
				type="Fire Spirit","Shadow Spirit"
			[/filter]
			[modify_unit]
				[filter]
					id=$unit.id|
				[/filter]
				max_hitpoints=$($unit.max_hitpoints * 1.4)
				hitpoints=$($unit.max_hitpoints * 1.4)
			[/modify_unit]
		[/event]
		
		{GENERIC_UNIT 2 "Shadow Spirit" 17 4}{VOADAR_ANIMATE_IN}
		{GENERIC_UNIT 2 "Shadow Spirit" 17 7}{VOADAR_ANIMATE_IN}
		
		# Still summoning each turn, but in a different spot
		{VARIABLE Ronry.summon_x 14}
		{VARIABLE Ronry.summon_y 4}
		
		# After you attack again, he starts getting frustrated
		[event]
			name=attacker hits
			[filter_second]
				id=Ronry
			[/filter_second]
			[event]
				name=new turn
				{VOADAR_MESSAGE_RIGHT Ronry (_"Grr..! Get back!!!")}
				{VOADAR_SPELL (
					{TELEPORT_UNIT (id=Voadar) 12 5}
					[terrain]
						x,y=16,5
						terrain=Uu^Dr
					[/terrain]
				)}
			[/event]
		[/event]
		
		# and when you're about halfway
		[event]
			name=attack end
			[filter_condition]
				[have_unit]
					id=Ronry
					formula=hitpoints <= max_hitpoints - 100
				[/have_unit]
			[/filter_condition]
			[fire_event]
				name=phase_four
			[/fire_event]
		[/event]
	[/event]
	
	[event]
		name=phase_four
		id=phase_four
		{VOADAR_MESSAGE_RIGHT Ronry (_"OW! Why does that <i>pant</i> hurt so much?! I'm not that <i>pant</i> tired yet! Time to finish this!")}
		{VOADAR_SPELL (
			[heal_unit]
				[filter]
					id=Voadar
				[/filter]
				moves=full
				restore_attacks=yes
			[/heal_unit]
			{TELEPORT_UNIT (id=Voadar) 12 5}
			[kill]
				side=2
				# includes Ronry
			[/kill]
			{VOADAR_RONRY (_"Ronry") mage}
		)}
		{VOADAR_MESSAGE_RIGHT Ronry (_"<i>(Completely out of breath)</i> This was always my <i>(gasp!)</i> favorite form! You're <i>(gasp!)</i> done for!")}
		{VOADAR_SPELL (
			[terrain]
				terrain=Uu^Yru
				x=14,15,16, 14-16
				y=3, 4, 3,  7
			[/terrain]
			[terrain]
				terrain=Uu
				x=13,13, 14,  15,  17, 17
				y=4, 7,  4-6, 5-6, 3-4,7-8
			[/terrain]
			[terrain]
				terrain=Wog
				x,y=16,4
			[/terrain]
		)}
		
		# no more minion hp boost
		{VOADAR_REMOVE_EVENT stronger_spirits}
		
		{GENERIC_UNIT 2 "Fire Spirit" 15 5}{VOADAR_ANIMATE_IN}
		{GENERIC_UNIT 2 "Shadow Spirit" 15 6}{VOADAR_ANIMATE_IN}
		{GENERIC_UNIT 2 "Fire Spirit" 16 5}{VOADAR_ANIMATE_IN}
		{GENERIC_UNIT 2 "Fire Spirit" 17 5}{VOADAR_ANIMATE_IN}
		{GENERIC_UNIT 2 "Shadow Spirit" 17 6}{VOADAR_ANIMATE_IN}
		
		# Twice the summons now, and back to the original summon spot
		{VARIABLE Ronry.summon_x 20}
		{VARIABLE Ronry.summon_y 5}
		[event]
			name=side 2 turn refresh
			id=Ronry_extra_summon
			first_time_only=no
			# but she only gets the extra summon if doesn't have tons already
			[filter_condition]
				[have_unit]
					side=2
					count=1-6
					# count includes Ronry
				[/have_unit]
			[/filter_condition]
			[set_variable]
				name=Ronry.rando
				rand="Fire Spirit","Shadow Spirit"
			[/set_variable]
			{GENERIC_UNIT 2 $Ronry.rando| 20 4}{VOADAR_ANIMATE_IN}
			[+unit]
				moves=0
				attacks_left=0
			[/unit]
		[/event]
		
		# But you've picked up on one of his tricks
		{VARIABLE Voadar.spawned_yet_this_turn no}
		[event]
			name=new turn
			id=allow_new_spawn
			first_time_only=no
			{VARIABLE Voadar.spawned_yet_this_turn no}
		[/event]
		[event]
			name=enter_hex
			[filter]
				id=Voadar
			[/filter]
			{VOADAR_MESSAGE_NARRATOR (_"You can feel the room pulsating with the vast magical energy Ronry has poured into it. You've never used magic before, but after watching Ronry's spells closely, there is one you may be able to replicate. Use the <b>right-click</b> menu on a tile near Voadar to try.")}
			[cancel_action]
			[/cancel_action]
			
			[set_menu_item]
				id=spawn_minion
				description=_"Summon Spirit"
				image=buttons/WML-custom.png
				[default_hotkey]
					key=e
				[/default_hotkey]
				[show_if]
					[variable]
						name=Voadar.spawned_yet_this_turn
						equals=no
					[/variable]
					[have_location]
						x,y=$x1,$y1
						[filter_adjacent_location]
							[filter]
								id=Voadar
							[/filter]
						[/filter_adjacent_location]
					[/have_location]
					[not]
						[have_unit]
							x,y=$x1,$y1
						[/have_unit]
					[/not]
				[/show_if]
				[command]
					{VARIABLE Voadar.spawned_yet_this_turn yes}
					[set_variable]
						name=Ronry.rando
						rand="Fire Spirit","Shadow Spirit"
					[/set_variable]
					{GENERIC_UNIT 1 $Ronry.rando| $x1 $y1}{VOADAR_ANIMATE_IN}
					[+unit]
						moves=0
						attacks_left=0
					[/unit]
				[/command]
			[/set_menu_item]
		[/event]
					
		# And finally, when you beat her once and for all
		[event]
			name=die
			id=kill_ronry
			[filter]
				id=Ronry
			[/filter]
			# final words, narrator note? em, honestly not sure
			[endlevel]
				result=victory
			[/endlevel]
		[/event]
	[/event]
	
	
	# Ronry never moves
	[event]
		name=side 2 turn refresh
		id=ronry_stays_put
		first_time_only=no
		[modify_unit]
			[filter]
				type=Voadar Mayor
			[/filter]
			moves=0
		[/modify_unit]
	[/event]
	
	[event]
		name=die
		id=voadar_dies_lose_game
		[filter]
			id=Voadar
		[/filter]
		[endlevel]
			result=defeat
		[/endlevel]
	[/event]
[/scenario]

#undef VOADAR_RONRY
#undef VOADAR_SPELL














